---
#https://github.com/geerlingguy/ansible-role-jenkins/
#https://github.com/jcalazan/ansible-jenkins

#for vagrant pay attention >>> hosts: = name in global status
#  config.vm.define "srv_eva"
- hosts: srv_eva777
#- hosts: all
  become: yes
  tasks:
  #need check
  - name: Install packages and dependencies
    apt: name={{ item }} update_cache=yes state=present
    with_items:
    - default-jdk
    - libfontconfig
    - libffi-dev
    - libncurses5-dev

  - name: Add the Jenkins public GPG key to the apt repo
    apt_key: url=http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key
           state=present

  - name: Add Jenkins to the trusted sources list
    apt_repository: repo='deb http://pkg.jenkins-ci.org/debian binary/'
                  update_cache=yes
                  state=present
  - name: Install Jenkins server
    apt: name=jenkins state=present
  
  - name: get contents of file - Jenkins pass
    command: cat /var/lib/jenkins/secrets/initialAdminPassword
    register: jenkins11
    become: true
  - name: Unlock Jenkins password
    debug: msg={{jenkins11.stdout_lines}}
    #debug: var=xxx.stdout_lines